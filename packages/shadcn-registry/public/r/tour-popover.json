{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "tour-popover",
  "type": "registry:component",
  "title": "Tour Popover",
  "description": "Smart popover with floating/docked/mobile layouts, drag support, and smooth animations via Floating UI.",
  "dependencies": [
    "@flowsterix/headless",
    "motion",
    "@floating-ui/dom"
  ],
  "registryDependencies": [
    "tour-provider"
  ],
  "files": [
    {
      "path": "registry/flowsterix/tour-popover.tsx",
      "content": "'use client'\n\nimport type { StepPlacement } from '@flowsterix/core'\nimport {\n  TourPopoverPortal,\n  useTour,\n  useTourTarget,\n  type TourPopoverLayoutMode,\n  type TourPopoverPortalRenderProps,\n} from '@flowsterix/headless'\nimport * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport type { TourPopoverLayoutMode }\n\nexport interface TourPopoverProps {\n  /** Additional class names for the popover container */\n  className?: string\n  /** Additional class names for the content wrapper */\n  contentClassName?: string\n  /** Offset distance from the target element (default: 16) */\n  offset?: number\n  /** Preferred placement relative to target */\n  placement?: StepPlacement\n  /** Fixed width for the popover */\n  width?: number | string\n  /** Maximum width for the popover */\n  maxWidth?: number | string\n  /** Z-index for the popover (default: 1001) */\n  zIndex?: number\n  /** ARIA role for the popover (default: \"dialog\") */\n  role?: string\n  /** ARIA label for the popover */\n  ariaLabel?: string\n  /** Whether the popover is modal (default: false) */\n  ariaModal?: boolean\n  /** Show drag handle for docked/manual mode (default: true) */\n  showDragHandle?: boolean\n  /** Custom content renderer */\n  children?: React.ReactNode\n}\n\n// =============================================================================\n// Drag Handle Component\n// =============================================================================\n\ninterface DragHandleProps {\n  dragHandleProps: TourPopoverPortalRenderProps['dragHandleProps']\n  className?: string\n}\n\nfunction DragHandle({ dragHandleProps, className }: DragHandleProps) {\n  const { style, ...rest } = dragHandleProps\n  return (\n    <button\n      {...rest}\n      style={style as React.CSSProperties}\n      className={cn(\n        'absolute -top-2 left-1/2 -translate-x-1/2 cursor-grab active:cursor-grabbing',\n        'h-5 w-10 flex items-center justify-center',\n        'text-muted-foreground hover:text-foreground transition-colors',\n        className,\n      )}\n    >\n      <svg\n        width=\"24\"\n        height=\"4\"\n        viewBox=\"0 0 24 4\"\n        fill=\"currentColor\"\n        aria-hidden\n      >\n        <rect x=\"0\" y=\"0\" width=\"24\" height=\"1.5\" rx=\"0.75\" />\n        <rect x=\"0\" y=\"2.5\" width=\"24\" height=\"1.5\" rx=\"0.75\" />\n      </svg>\n    </button>\n  )\n}\n\n// =============================================================================\n// Main Component\n// =============================================================================\n\nexport function TourPopover({\n  className,\n  contentClassName,\n  offset = 16,\n  placement,\n  width,\n  maxWidth = 360,\n  zIndex = 1001,\n  role = 'dialog',\n  ariaLabel,\n  ariaModal = false,\n  showDragHandle = true,\n  children,\n}: TourPopoverProps) {\n  const { state, activeStep } = useTour()\n  const target = useTourTarget()\n\n  const isRunning = state?.status === 'running'\n\n  if (!isRunning || !activeStep) {\n    return null\n  }\n\n  // Get placement from step or props\n  const resolvedPlacement = activeStep.placement ?? placement ?? 'bottom'\n\n  return (\n    <TourPopoverPortal\n      target={target}\n      offset={offset}\n      placement={resolvedPlacement}\n      width={width}\n      maxWidth={maxWidth}\n      zIndex={zIndex}\n      role={role}\n      ariaLabel={ariaLabel}\n      ariaModal={ariaModal}\n    >\n      {({\n        Container,\n        Content,\n        containerProps,\n        contentProps,\n        layoutMode,\n        showDragHandle: shouldShowHandle,\n        dragHandleProps,\n        descriptionProps,\n      }) => (\n        <Container\n          {...containerProps}\n          className={cn(\n            // Base styles\n            'rounded-xl border bg-popover text-popover-foreground shadow-lg',\n            // Mobile mode takes full width\n            layoutMode === 'mobile' && 'w-[calc(100vw-24px)] max-w-md',\n            className,\n          )}\n        >\n          {/* Drag handle for docked/manual mode */}\n          {showDragHandle && shouldShowHandle && (\n            <DragHandle dragHandleProps={dragHandleProps} />\n          )}\n\n          {/* Content with crossfade animation */}\n          <Content {...contentProps} className={cn('p-4', contentClassName)}>\n            {/* Screen reader description */}\n            {descriptionProps.id && descriptionProps.text && (\n              <span id={descriptionProps.id} className=\"sr-only\">\n                {descriptionProps.text}\n              </span>\n            )}\n\n            {/* Render step content or custom children */}\n            {children ?? activeStep.content}\n          </Content>\n        </Container>\n      )}\n    </TourPopoverPortal>\n  )\n}\n",
      "type": "registry:component"
    }
  ],
  "categories": [
    "tour",
    "popover"
  ]
}