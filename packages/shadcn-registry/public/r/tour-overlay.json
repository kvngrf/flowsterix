{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "tour-overlay",
  "type": "registry:component",
  "title": "Tour Overlay",
  "description": "A customizable spotlight overlay that highlights the target element with a dimmed backdrop.",
  "dependencies": [
    "@flowsterix/headless",
    "motion"
  ],
  "registryDependencies": [
    "tour-provider"
  ],
  "files": [
    {
      "path": "registry/flowsterix/tour-overlay.tsx",
      "content": "'use client'\n\nimport { useTour, useTourOverlay, useTourTarget } from '@flowsterix/headless'\nimport { AnimatePresence, motion } from 'motion/react'\nimport * as React from 'react'\nimport { createPortal } from 'react-dom'\n\nimport { cn } from '@/lib/utils'\n\nexport interface TourOverlayProps {\n  /** Additional class names for the overlay */\n  className?: string\n  /** Padding around the highlighted target (default: 8) */\n  padding?: number\n  /** Border radius of the highlight cutout (default: 8) */\n  radius?: number\n  /** Background color/opacity of the overlay (default: \"rgba(0, 0, 0, 0.5)\") */\n  backdropColor?: string\n  /** Whether clicking the backdrop advances/dismisses the tour */\n  backdropClickBehavior?: 'none' | 'advance' | 'dismiss'\n  /** Optional ring/glow effect around the target */\n  showRing?: boolean\n  /** Ring color (default: \"rgba(255, 255, 255, 0.3)\") */\n  ringColor?: string\n  /** Z-index for the overlay (default: 1000) */\n  zIndex?: number\n}\n\nexport function TourOverlay({\n  className,\n  padding = 8,\n  radius = 8,\n  backdropColor = 'rgba(0, 0, 0, 0.5)',\n  backdropClickBehavior = 'none',\n  showRing = true,\n  ringColor = 'rgba(255, 255, 255, 0.3)',\n  zIndex = 1000,\n}: TourOverlayProps) {\n  const { state, activeStep, next, cancel } = useTour()\n  const target = useTourTarget()\n  const overlay = useTourOverlay({ padding, radius })\n\n  const isRunning = state?.status === 'running'\n  const isScreenTarget = activeStep?.target === 'screen'\n  const rect = target.rect ?? target.lastResolvedRect\n\n  const handleBackdropClick = React.useCallback(() => {\n    if (backdropClickBehavior === 'advance') {\n      next()\n    } else if (backdropClickBehavior === 'dismiss') {\n      cancel('backdrop-click')\n    }\n  }, [backdropClickBehavior, next, cancel])\n\n  if (!isRunning || !activeStep) {\n    return null\n  }\n\n  // For screen targets, just show a simple backdrop\n  if (isScreenTarget) {\n    const content = (\n      <AnimatePresence>\n        <motion.div\n          key=\"screen-backdrop\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.2 }}\n          className={cn('fixed inset-0', className)}\n          style={{\n            zIndex,\n            backgroundColor: backdropColor,\n            pointerEvents: backdropClickBehavior === 'none' ? 'none' : 'auto',\n          }}\n          onClick={handleBackdropClick}\n          aria-hidden=\"true\"\n        />\n      </AnimatePresence>\n    )\n\n    if (typeof document === 'undefined') return null\n    return createPortal(content, document.body)\n  }\n\n  // For element targets, use clip-path to create spotlight effect\n  const clipPath = rect\n    ? createSpotlightClipPath(rect, padding, radius)\n    : undefined\n\n  const content = (\n    <AnimatePresence>\n      <motion.div\n        key=\"element-backdrop\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        transition={{ duration: 0.2 }}\n        className={cn('fixed inset-0', className)}\n        style={{\n          zIndex,\n          backgroundColor: backdropColor,\n          clipPath,\n          pointerEvents: backdropClickBehavior === 'none' ? 'none' : 'auto',\n        }}\n        onClick={handleBackdropClick}\n        aria-hidden=\"true\"\n      />\n\n      {/* Highlight ring around target */}\n      {showRing && rect && (\n        <motion.div\n          key=\"highlight-ring\"\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          exit={{ opacity: 0, scale: 0.95 }}\n          transition={{ duration: 0.2, delay: 0.05 }}\n          className=\"pointer-events-none fixed\"\n          style={{\n            zIndex: zIndex + 1,\n            left: rect.left - padding - 2,\n            top: rect.top - padding - 2,\n            width: rect.width + padding * 2 + 4,\n            height: rect.height + padding * 2 + 4,\n            borderRadius: radius + 2,\n            boxShadow: `0 0 0 2px ${ringColor}, 0 0 20px 4px ${ringColor}`,\n          }}\n          aria-hidden=\"true\"\n        />\n      )}\n    </AnimatePresence>\n  )\n\n  if (typeof document === 'undefined') return null\n  return createPortal(content, document.body)\n}\n\n/**\n * Creates a CSS clip-path that cuts out a rounded rectangle for the spotlight effect.\n * Uses polygon with inset to create the \"hole\" in the overlay.\n */\nfunction createSpotlightClipPath(\n  rect: DOMRect,\n  padding: number,\n  radius: number,\n): string {\n  const x = rect.left - padding\n  const y = rect.top - padding\n  const w = rect.width + padding * 2\n  const h = rect.height + padding * 2\n\n  // Create an inset path that carves out the target area\n  // This creates a full-screen polygon with a rectangular hole\n  return `polygon(\n    0% 0%,\n    0% 100%,\n    ${x}px 100%,\n    ${x}px ${y + radius}px,\n    ${x + radius}px ${y}px,\n    ${x + w - radius}px ${y}px,\n    ${x + w}px ${y + radius}px,\n    ${x + w}px ${y + h - radius}px,\n    ${x + w - radius}px ${y + h}px,\n    ${x + radius}px ${y + h}px,\n    ${x}px ${y + h - radius}px,\n    ${x}px 100%,\n    100% 100%,\n    100% 0%\n  )`\n}\n",
      "type": "registry:component"
    }
  ],
  "categories": [
    "tour",
    "overlay"
  ]
}